\chapter{Thesis and Summary}

\section{Summary}

The topic of this PhD dissertation is optimal current control. The aim of the research was to apply and simulate high frequency controllers with optimization purpose of cost functions with the presence of constraints and circumstances, on controlled switch based power electronic devices.\\
In chapter \oldref{VUB:sec:Main}, a current controlled inverter structure was presented, connected to a small, domestic grid, representing the connection of a household with possible renewable (or other) generators, to balance consumption. The examined grid, the phenomena of voltage unbalance was assumed to be present, as the main problem, of which this device was ought to not only handle, but mitigate within the limit of its physical capabilities. For this reason, first an indicator was established, based on a proposed geometrical operation, as a voltage unbalance norm candidate (section \oldref{VUB:sec:Geom}). This norm was calculated from the symmetrical difference between the convex hull of voltage phasor vectors, always present on a three phase network. The idea was, that any deviation from the ideal phasor, (which first vector assumed in phase with the ideal one) introduces sub-optimal behavior, or fault of appliances connected. This way the already present indicators of voltage unbalance was examined (section \oldref{VUB:sec:AdditionalContent}). Afterwards found that not only, they vary in result, but ignore phase differences, or the zero-sequence component (based on the Fortescue method), or its ponderous to serve as a cost function need to be minimize. The proposed geometrical norm however considers all of the above, with the addition that since it calculates area, instead of vector length differences, the result is a square-like function, serves as an excellent candidate. The downside is the yet unresolved computational overload, that is method introduces.\\
In the next phase, the network's unbalance was attempted to be mitigated by designing a power electronic converter for a household, which utilizes an external power source (a photo voltaic source in this case) for counter balance (section \oldref{VUB:sec:Compensation}). This way some obstacles needed to be dealt with, first and foremost, the highly stochastic nature of the network. It was assumed, that the device has no external information, rather than the voltage, measured at the network connection point. This way a non-model based asynchronous parallel pattern search (APPS) controller was designed and applied based on the said geometrical norm, which decreases the cost regardless of unknown circumstances. Furthermore, the device needed various subunits, to efficiently handle the power flow in all three phases, namely power-point-tracking, intermediate voltage control, and per-phase current injection was required. The results were tested in Matlab/Simulink environment with simulating the actual device via Simscape, and the unbalanced network, also with experimental measurements. The result was, that the controller could reduce the network's voltage unbalance, based on the network's robustness (how large is the impedance, which created the unbalance), how much control reserve is present as energy source, and physical boundaries (the device can not supply infinite current). Based on this the household's normal operation can withheld even in with unbalanced loads.\\
Lastly in chapter \oldref{EMPC:sec:main} in-depth modeling and predictive control task has been performed, on one power electric component, namely on a buck-type rectifier. This rectifier uses current source operation to supply the load it is connected to. The main goal was to create on the Kirchhoff's law based differential equations a model based predictive controller, suited to reach the reference point with the best dynamics. It was also taken in mind, that an implicit MPC would not be up to the task, sice every control rule was to be re-calculated from scratch, implying a very expensive CPU. This gap could be bridged by reaching out for the explicit MPC method, by partitioning the state space, on a pre-defined rule set. This way the control demand could be reduced significantly, however, this is not suited for high rank systems. As such the system's bi-linearity was eliminated by applying on the premise that two dynamics which have highly different fundamental frequencies can operate in superposition. This way the problem was simplified, and explicit MPC could be implemented in DC-side, whilst active damping at the AC-side. The method's efficiency was tested in Matlab/Simulink environment against a conventional state-feedback controller, with good results. Additionally the computational demand was evaluated, with assumed binary search algorithm.\\

\section{New scientific results}

\begin{enumerate}[I.)]

\item\textbf{Thesis}: \emph{Geometrical indicator for voltage unbalance in three phase networks}\\
    \textbf{Related publications:} \cite{neukirchner2015examination}, \cite{Neukirchner2015}.\\
    I extended the currently used measures of voltage unbalance with a new norm candidate. I found out that it is more demanding from the computational point of view, but has a new feature namely it checks electrical asymmetry, i.e. the norm of a $\pm120$ degree rotated version of the ideal three phase phasor is zero in the geometrical sense. I compared my geometrical approach to the standard wide-spread use of voltage unbalance factor (VUF) and found out it carries additional information, whilst retaining it's original purpose.\\
		
\item\textbf{Thesis}: \emph{Voltage unbalance compensation with optimization based control algorithm and asymmetrical inverter structure}\\
    \textbf{Related publications:} \cite{Neukirchner2015}, \cite{neukirchner2016voltage}, \cite{neukirchner2017voltage}.\\
     I found out that the regular current controlling applications would not fit to the purpose for reducing voltage unbalance whilst only relying on the voltage measurement. As such I developed an asymmetrical current source inverter (ACSI) circuit with combined asynchronous parallel pattern search (APPS) control structure, in Matlab/Simulink environment, and I applied the my geometrical norm as a cost function. I showed with validating simulations, that the geometrical based unbalance indicator can serve as a basis of further research. \\
		The fundamental element of the system is a modified three phase inverter that is capable of the asymmetric injection of any current waveforms to the network. The optimization based control algorithm injects the available energy (as current waveform) in such a way, that the voltage unbalance decreases. The structure enables to show that any point the inverter is connected, could restore power quality with a certain degree such unbalance compensation. This optimization problem is usually constrained by the available renewable energy supplied by the power plant. This suggested controller with combined inverter structure enables the residential users owning a grid synchronized domestic power plant to reduce voltage unbalance measurable at any low voltage domestic the connection point. \\
    I also tested the control structure on a real low voltage network model in a dynamical simulation environment consisting of the models of the electrical grid, a domestic power plant, ACSI, and different types of loads. Different simulation experiments has been run for each norm and for both the power constrained and unconstrained case. I showed with the evaluation that this structure can serve as a residential level voltage quality improvement method for the three phase low voltage network.\\
		
		\item\textbf{Thesis}: \emph{Constrained, explicit predictive control for current source buck-type rectifiers}\\
        \textbf{Related publications:} \cite{neukirchner2020constrained}.\\
    I proposed a simplified CSR model, which was derived from the well known CSR structure and was examined from design and implementation points of view with the purpose of explicit model-based predictive control. The regular set of differential equations of the CSR appeared to be too complex for my a design approach, for applying explicit predictive control. \\
		I adressed this issue with the separation AC and DC equation sets was of the CSR to decrease complexity and easy controller design. With this solution I eliminated bi-linearity and enabled the application of linear control design techniques. I used current-based SVPWM the modulation, what has been used with an emphasis on the reduction of switching losses. \\
		For DC side control I implemented explicit model predictive control (EMPC) and I compared this method's effectiveness to conventional state feedback control. I implemented the CSR structure and the proposed controller with EMPC on DC and active damping on the AC side in Matlab/Simulink environment and tested by simulation. Additionally, I tested the proper implementation's computational requirements in a modern DSP chip, which would serve in real-time operation.\\
	
\end{enumerate}

Publications not related to the thesis:  \cite{neukirchner2011modeling}, \cite{neukirchner2014quasi}, \cite{gollei2014measurement}, \cite{neukirchner2016modelling}.


		\section{Applications and future work}
		
		In this section the possible applications shall be described based on my thesis. These are not yet scope of current research activities, but can serve as a potential direction and evolution for these results.
		
		\subsection{Geometrical voltage unbalance norm}
		
		As mentioned the geometrical norm's largest weakness is the computational demand. The required areas, computed from the voltage phasors realized with the corresponding Matlab functions, which are not designed for continuous calculation, especially not for time constants for power electronic devices. This can be resolved, via replacing the calculation of the symmetrical difference (difference between the two polygon's union and intersection) with finite-element method, with scalability, where the segmentation's resolution would be adjustable and based on the corresponding simulation's (or system's) time constant and the simulator machine's calculation capabilities. After this, the calculation method shall be phrased in an traditional equation form, using the toolset of set theory, and linear algebra. This way, the norm's calculation could be further reduced, and could be implemented on a cheaper embedded system.\\
		The geometrical norm's usefulness was already proven compared o the regular $VUF$ method. However the robustness of the method seems implicitly proven, is shall be tested on real conditions, even in extreme (faulty) situations, and with such hard constrains could be defined, where the algorithm outlives its usefulness. This way, instead of just a resulting number, a full formulation of an optimization problem could be utilized, presented in section \ref{BASICCSR:sec:OptimalControl}, with model based predictive capabilities. This can be further enhanced, with recognizing different scenarios, form general inefficiency, to fault prediction, or handling (like graceful degradation).
		
		\subsection{Voltage unbalance reducing inverter structure}
		
		The inverter structure employ a variety of subsystems, which shall work together in harmony. A global optimum shall be defined (with weighting the various factors) based on external circumstances, and the customers needs. This way, the individual Kirchhoff equations based differential equations shall be established, and controller designed.\\
		This way the system's physical properties shall be scalable (based on a household's needs and its energy producing and storing capabilities), as in designing a real power electric system for implementation. Next actual implementation shall be proceeded, with prototype realization on a test bench, with a simulated domestic network connection. Further step to test the presence of multiple of such devices on the network, and how they could mitigate unbalance in synchronous or asynchronous operation. \\
		The APPS method, however fulfills its optimizing responsibilities very well in such an environment, where changes are expected to be highly stochastic, based on network knowledge, a netwok- and/or device model based optimal control shall be established, where various current and voltage inertias can be taken into account, giving a leverage for prediction.
		
		\subsection{Explicit model predictive control for buck-type rectifier}
		
		From mathematical perspective it is an alternative possibility to take the harder route and take the inherent bilinearity into account. This way, the devices equations should not be partitioned, and a hybrid design can be commenced. This has been performed in the literature, but seldom on three phase systems, for complexity reasons.\\ The topology could be altered, by removing (or greatly decreasing) some of the device's filtering  capabilities, in inductive or capacitive terms (some inductors, like the choke $L_{dc}$ are non-removable), and try to outsource this problems to the controller itself to some degree.\\
		Try the cost function from Euclidean norm to an infinity norm, and also give stricter constrains. The optimum could be power throughput based instead of a specified current. The types of loads can be extended, and merged with the current equation system. This enables to expand the research on electric machinery, where starting/ breaking dynamics can be tested. On the other side, the effects on the supplying network can be taken into consideration, further reducing harmonics, and test conditions in the presence of unbalance.
		Lastly, experimental results shall be performed on a device, further validating its usefulness, and implement the used S-function from Simulink to an embedded system.
