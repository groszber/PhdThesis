\chapter{Introduction}

%==== Free text =====================================================
Growth of distributed generation from renewable energy sources and the nature of the electrical power grid initiated a trend to alter from a passive network to an active one. So called smart grids have the ability to provide much more in depth observable measurement results of their customers, grid operators and energy traders alike. Through voltage and current measurements, the habits of each actor (household, station, or industrial- commercial facility) can be easily mapped and taken into account. Moreover, the potential failure could be indicated and preemptively acted upon, before irreversible malfunction, significant amount of wear, or generally, the efficiency of energy consuming actor's power electric consumer's diminishes. In most cases, only smart metering is present, whilst central control and measurement is not an option.\\
In this new environment, the importance and difficulty of maintenance and operational stability and cost effective control of the distribution system are increasing together. With this in mind local solutions are the most convenient solutions, and as opposed to this expectation most of a household's possible renewable sources and loads are unevenly distributed, without mindful control over single phase power converters. Some of these could represent an unevenly high power consumption, or worse a locally significant energy source in times where it's most unnecessary, especially outside peak zones of consumption. The situation is further exacerbated by the stochastic on/off switching of the different types of loads. This cause stochastic disturbing unbalance in the load currents which cases unbalanced load of the low voltage transformer, and amplitude- and phase unbalance in the voltage phasor trough the serial impedance of the low voltage transportation line wires and connecting devices cables.\\
If we observe the opposite side, ideal generators supply symmetrical three-phase sinusoidal positive sequence voltages, which are balanced in terms of their amplitudes phase differences at a single frequency. With this in mind voltage (as such consumption- and production-) unbalance occurs on the network. The terminology of unbalance can be divided into amplitude unbalance, phase difference unbalance, and unbalanced harmonic disturbance. The occurrence of at least one of these features is enough for a distribution network to become unbalanced. \\
Many countries have changed their regulating laws about power supply to allow for grid-tie inverter systems to provide spare power from renewable sources to local low voltage grids.The unbalance of the grid is further increased by using single phase grid tie inverter systems in the size of typical small household power plants (1 - 50\,kW) and the produced electrical power originating from renewable power source (wind and solar) also admits stochastic behavior. This unbalance yields to a suboptimal operation of low voltage three phase transformers and machines to generate undesirable additional yield loss and increase in the probability of malfunction of the low voltage energy transportation system's components, or the effective current unbalance could cause additional power loss of the transportation line resistances or in the end complete shutdown.\\
To mitigate or avoid such situations an approach is required, where the system where aforementioned phenomena occurs is an optimization problem. However to formulate an optimization problem, many things should be established to formulate it properly. Most importantly, a cost function should be established which can be served as a measure of goodness for solving the question. For instance, if voltage unbalance would be eliminated, than the correct indicator of unbalance should serve as basis, moreover the deviation from the optimum could be quadratic.\\
Such tasks can not be achieved without proper instrumentation. To be able to apply control, where he voltage levels are designated, and the end user has no direct control (only the plant or transformer level has such), deviations can be addressed, and current control can be used as actuation. This way a control structure can be imagined for a power electric converter, where every step should count towards the optimum state, with respect to the energy (or control reserves), wear of the device (sub components, namely gates have finite switching capabilities), and  safety constraints ( designated level of current and voltage should not trespass a given hard constraint for the sake of malfunction avoidance, and soft constraint for the sake of reducing wear). Additionally it should not be forgotten, that with all the above, the device should operate in the domains of kHz or above, and it should be run on a cheap device, like an embedded micro-controller chip or digital signal processor (DSP). With all this in mind a power electric structure can be designed to fulfill the high standards of today’s requirements. The problem is, conventional controllers can not achieve al this requirements. The methodology based on optimal control, was originally designed for highly complex, and safety critical systems, with huge amount of inputs and outputs, power plants, and chemical- or refinery plants. These systems though, have an incomparably lower time constant, which renders conventional model based predictive controllers useless in the domain of power electronics. \\
To marry the two approaches together, a solution came up from the automotive industry. A car is also a highly safety critical multiple-input, multiple-output (MIMO) system with obvious constraints, in increasingly changing environment. The main point is, to map the state and input space of the environment, significantly reducing calculation demands based on the system complexity. Where constraints are present, finite states can be defined, either by hand (e.g. state machines) or by advanced mapping algorithms, and then in every state of operation, a relatively simple (linear if possible)  rule where one state of the system dynamics could be substituted, then to make sure stepping on to the next most applicable rule can be achieved very fast. This way, by choosing the resolution of the mapping correctly (too fine resolution gives too high processing requirements, too low gives suboptimal dynamics), the predictive control approach can be applied in both worlds.\\


%\section{Literature overview}
%
%%============ RENEWABLE SYSTEM
%Single phase power injections to the grid are mainly generated by domestic photovoltaic-(PV) and wind power plants. For off-grid, sometimes more complex solutions integrating diesel generators, PV and wind generators. Such as proposed, in \cite{shezan2016}, and \cite{cucchiella2013environmental}, where presented the economical aspects of a PV system. The economic results are strongly influenced by the annual average isolation value, which encourages the areas most exposed to the sun and the southern areas. The consumption of consumers is not critically important, but the design principle used has as significant effect on the maximization of the performance of PV plants. In the paper \cite{kaldellis2009optimum} it is worth noticing, that autonomous photovoltaic systems are strongly responsible of their reactive energy requirements. To support photovoltaic systems with sufficient battery banks one should be able to establish that their reactive energy requirement share fairly compensated by the corresponding energy yield.  Additionally, in \cite{ortega2013measurement} the author emphasizes that PV systems are increasingly being deployed in all over the world, and this is the source of a wide range of power quality problems. With a view on consistently measuring and assessing the power quality characteristics of PV systems, they had presented an in-depth overview and discussion of this topic.\\
%%============ EV SYSTEM
% The study \cite{huat2015integration} explored implementation issues of electric vehicle battery packs. They suggest that high voltage battery packs with large format cells has advantages in assembly, thermal management, monitoring and control, services and maintenance. On the other hand, quality, reliability and limited specific energy of large format cells are obstacles need to overcome. Solving these problems will further affect the cost, performance, reliability and safety of the electric vehicles. Smart energy systems in specially in urban areas are discussed in \cite{lund2015smart} where a design methodology has been suggested.\\
%%============ EFFECTS OF UNBALANCE
%Many power systems, voltage parameters change over time. Variation of power quality leads to thermal transients in electrical machines. This problem can be especially important in the case of low-power machines, because they have shorter time constants than high-power ones. The rate of thermal responses of a machine also significantly depends on the type of power quality disturbances. Voltage unbalance can cause  machine  overheating  within  a  mere  few  minutes. Furthermore,  fluctuating  unbalance  could  cause  an  extraordinary rise  in  windings  temperature  and  additional  thermo-mechanical stress.  Consequently,  voltage  unbalance  is  found  to  be  more harmful to induction motors than the results from previous work \cite{gnacinski2019induction}. Additionally beside the heat factor, voltage unbalance can cause increased reactive power \cite{savaghebi2012secondary}, various copper loss \cite{siddique2004effects} torque pulsation in electric motors \cite{brekken2005control}. The authors of \cite{lee1998effects} were discussing the effects of unbalanced voltage on a three-phase induction motor, one has to consider not only negative-sequence voltage but also the positive-sequence voltage. With the same voltage unbalance factor, the status of voltage unbalance could be judged by the magnitude of positive sequence voltage. Also the effect of voltage unbalance has been studied on three-phase four-wire distribution networks for different control strategies for three-phase inverter-connected distributed generation units on voltage unbalance in distribution networks \cite{meersman2011three}. Here the negative-sequence component and the zero sequence component were studied where unbalance conditions could lower stability margin and increasing the power losses. On the other hand, the adaptive coordination of distribution systems included distributed generation is also an emerging problem as it was discussed by \cite{ates2016}.  A small voltage unbalance might lead to a significant current unbalance because of low negative sequence impedance as highlighted in \cite{bina2011three}.\\
%%============ DEPARTMENT WORK REGARDING UNBALANCE
%As such a previous work of \cite{gorbe2012reduction} a complex control unit has been proposed that is capable of lowering extant harmonic distortion. In the work of \cite{Gorbe2014experimental} the effect of a small domestic (photovoltaic) power plant on the power quality, mainly the total harmonic distortion has been examined. The aim of this work is to examine and compensate three phase voltage asymmetry of the electrical network based on the extended simulation model proposed by \cite{gorbe2012reduction}. Further control methods were applied for the solution for balancing of the most sensitive with regard to electric energy quality part of power system in \cite{uimethod},  minimizing the active power losses, stabilization of three-phase voltages, enhancement of asynchronous machine performance stability and reduction of errors occurring in power consumption measuring circuits.\\
%%============ UNBALANCE CALCULATION
%In many articles the authors presents a different viewpoint of calculating unbalance on the network. \cite{martin2015unbalance} showed to assess the harmonic distortion and the unbalance introduced by the different loads connected to the same point of common coupling have been applied to an experimental distribution network.  By \cite{kini2007novel} the focus was to bring out the ambiguity that crops up when we refer to a particular value of voltage unbalance that exists in the system. By making use of the complex nature of voltage unbalance, the voltage combinations that lead to the calculation of complex voltage unbalance factor could be narrowed down to a great extent. A fast and accurate algorithm for calculating unbalance has been presented by \cite{wen2014approximate}. The magnitudes of zero, positive, and negative sequences are obtained through simple algebraic equations based on the geometric figure, which is also called as 4 and 8 geometric partitions. Also a three-phase optimal power flow calculation methodology has been presented by \cite{araujo2013three}, that is suitable for unbalanced power systems. The optimal algorithm uses the primal-dual interior point method as an optimization tool in association with the three-phase current injection method in rectangular coordinates.\\
%%============ UNBALANCE COMPENSATION
%There are different approaches of lowering the unbalance with different control techniques. Additionally, new computationally efficient control techniques have been presented by \cite{lee2009new} to estimate and compensate input voltage unbalance (VU) disturbances for a voltage source converter. These tools are designed to be effective with high power systems with slower PWM switching frequencies of 5 kHz or lower and limited current-controller bandwidth. About the unbalance compensation control aspect, a three-phase IGBT-based static synchronous compensator were proposed for voltage and/or current unbalance compensation by \cite{xu2010voltage}. An instantaneous power theory was used for real-time calculation and control. Three control schemes current control, voltage control and integrated control were proposed to compensate unbalanced voltage, unbalanced current or both. Unbalance phenomena and power quality can be examined with modeling too. A particular modeling method was presented by \cite{li2005microgrid}, where a three-phase four-wire grid-interfacing power quality compensator were modeled. During voltage unbalance, the compensator, used a shunt with a series four phase inverter, could enhance both the quality of power within the microgrid and the quality of currents flowing between the microgrid and utility system. In this case a microgrid is a group of interconnected loads and distributed energy resources within clearly defined electrical boundaries that acts as a single controllable entity with respect to the grid. A microgrid can connect and disconnect from the grid to enable it to operate in both grid-connected or island-mode. The shunt four-leg inverter were controlled to maintain a set of balanced distortion free voltages to regulate power sharing among the parallel-connected distributed generation systems. Simulation studies were carried out by \cite{Hu2016264} where one of the aims was to develop and test the feasibility of a decoupled three-phase on-load tap charger in the distribution system with the objective of improving the distribution network power quality. Further control methods were applied for the solution for balancing of the most sensitive with regard to electric energy quality part of power system by \cite{uimethod},  minimizing the active power losses, stabilization of three-phase voltages, enhancement of asynchronous machine performance stability and reduction of errors occurring in power consumption measuring circuits.\\
%%============ UNBALANCE COMPENSATON WITH OF CURRENT SOURCE CONVERTERS
%In the arsenal of voltage unbalance compensation, current source power electronic devices have a dedicated position. Based on the instantaneous active power theory under unbalanced  grid conditions \cite{wang2016dc} proposes an optimized negative-sequence current  references  for  eliminating  the double-frequency  oscillations  on  active  power  at  AC  side of a current source converter. The author argues in \cite{wang2014virtual} that a classification of the virtual impedances can greatly benefit an unbalance compensating control structure, with an active stabilization method. In \cite{guo2018advanced} direct control strategy with detailed current converter model is shown which is much simpler than the complicated instantaneous power theory approach. This solution needs less voltage and current sensors for the feedback control, which means that it is a cost-effective solution. An interesting, yet similar approach compared in the paper if a bi-directional current source topology is used like in \cite{vekhande2015control}. This enables to compensate a much larger degree of freedom handing unbalanced conditions with the precaution of unstable operation possibilities.\\
%%============ USAGE OF CURRENT SOURCE RECTIFIERS
%Current source rectifiers (CSR) are widely used in frond-end power electronic converter for the uncontrollable or controllable DC-bus in industrial and commercial applications. They have maintained their position through many applications, with uses such as medium-voltage high-power drives \cite{vajda2017limiting}, \cite{ghalem2010six} STATCOMs \cite{gupta2014two} and renewable systems \cite{chen2016single}, \cite{exposto2015predictive}. They have a plain and reliable circuit structure, which makes them attractive for simple control design. The CSRs are traditionally controlled by state feedback, or classic cascaded linear control loops such as PI controllers. These simple control applications are suitable for induction motor control \cite{chebre2011speed}, and other electromechanical actuators \cite{salloum2014robust}, and unusual topologies \cite{neukirchner2017voltage}. Also, worth mentioning of self-tuning variants of PI controllers \cite{tahri2012digital}.\\
%%============ MODULATION OF CSR
% In the past, the modulation methods used were trapezoidal pulse width modulation techniques (TPWM), or application of pulse patterns calculated off-line for selective harmonic elimination (SHE). More recently, current space vector modulation (SVM) has been used for the synthesis of the transistor control signals \cite{gao2017model}. Even so, AC-side harmonic elimination could still be an issue at lower switching frequencies where LCL filtering (inductive-capacitive-inductive) would be advised \cite{han2010control}.\\
%%============ TOPOLOGIES OF CSR
%In order to keep switching frequencies low and to minimize switching losses, new topologies and hybrid modulations are used, mixing TPWM and SHE depending on the grid frequency \cite{venkatraman2018multilevel}.\\
%%============ BENEFITS OF CSR
%    In terms of the amplitude of the grid and DC-link voltages, CSRs exhibit a step-down conversion. When used as DC voltage source, the rectifier can output a lower DC voltage without the need of a grid-side transformer, as is usually employed in voltage source rectifiers (VSR). Because of their current source behavior, CSRs can easily be paralleled and provide inherent short-circuit protection, representing an excellent potential in DC power supply applications \cite{feroura2017finite}, \cite{yan2015study}.\\		
%%============ GENERAL POWER ELECTRIC CONTROL
%    There are several control strategies in addition to classical PI control for applications in this domain. Self-adapting control methods are on the rise with more sophisticated algorithms in the field of fuzzy logic \cite{urmos2017application}. They are capable of handling increasingly more complicated models and systems with high dynamics and accuracy \cite{chatterjee2008augmented}, \cite{haidegger2012simulation}, and even without establishing and validating classical state-space models \cite{vrkalovic2018model}. The other filed is the sliding mode control, which can achieve good dynamic performance and handle non-linearity. Still, they might also introduce chattering, which can be very undesirable when applied to real-life systems like in \cite{regaya2014new} and \cite{szell2014mathematical}. Additionally in \cite{ahmed2014model} the validity of an MPC-based, digital pulse width modulation control strategy for single-phase voltage source rectifiers is discussed, further confirming the validity of this method in control systems.\\	
%%============ PREDICTIVE POWER ELECTRIC CONTROL		
%    In the linear domain implicit model predictive control (IMPC or MPC) is a fair solution due its effectiveness in power electronics because of its configurable cost function and such scalable nature \cite{kelemen2010constrained}, \cite{ahmed2014model}. In this field also finite-state solutions are present which can be considered also predictive control, where the modulation scheme’s defined states serve as optimization potential \cite{rivera2013predictive}, \cite{godlewska2015predictive}. As a further step adaptive application was established to tackle parameter estimation problems for better performance \cite{muthukumar2016adaptive}\\	
%%============ EXPLICIT PREDICTIVE CONTROL
%    Recently, beside implicit, finite-state, and adaptive predictive control, explicit model predictive control has emerged in the field of power electronics \cite{kutasi2010constrained}. Establishing the MPC cost function can range widely depending on the expected dynamics, degree of noise cancellation, and model complexity. Additionally, the current limitation can also be implemented introducing constraints in the modulation algorithm.\\	
\newpage 